# how much does amount of visualization affect these responses (just yes no)
contr_df <- math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) %>%
dplyr::rename("Proportion of time spent visualizing" = prop_of_time_1
, "Any causal control?" = causal
, "Any constraints on your control?" = constraint
, "Ever appear unprompted?"  = appear
, "Ever fade unprompted?"  = fade
, "Remain when unneeded?" = stay_present
, "Can't stop seeing them?" = stop_seeing
, "Ever annoyed by them?" = annoyed) %>%
pivot_longer(cols=c("Any causal control?":"Ever annoyed by them?"), names_to="control_q", values_to="response") %>%
mutate(response = as.numeric(response == "Yes")) %>%
drop_na(response)
source("~/.active-rstudio-document", echo=TRUE)
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df
##=---------------SIMPLER PLOT
# how much does amount of visualization affect these responses (just yes no)
contr_df <- math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) %>%
dplyr::rename(
#"Proportion of time spent visualizing" = prop_of_time_1
"Any causal control?" = causal
, "Any constraints on your control?" = constraint
, "Ever appear unprompted?"  = appear
, "Ever fade unprompted?"  = fade
, "Remain when unneeded?" = stay_present
, "Can't stop seeing them?" = stop_seeing
, "Ever annoyed by them?" = annoyed) %>%
pivot_longer(cols=c("Any causal control?":"Ever annoyed by them?"), names_to="control_q", values_to="response") %>%
mutate(response = as.numeric(response == "Yes")) %>%
drop_na(response)
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
View(math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed))
contr_df
contr.m <- lm(response ~ 1 + `Proportion of time spent visualizing` + control_q, data = contr_df)
library(gtsummary)
contr.m <- lm(response ~ 1 + `Proportion of time spent visualizing` + control_q, data = contr_df)
summary(contr.m)
contr_df %>% ggplot(aes(x=round("Proportion of time spent visualizing"/100, 1), y=response, color=control_q, group = control_q)) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round("Proportion of time spent visualizing"/100, 1), y=response, color=control_q, group = control_q)) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(`Proportion of time spent visualizing`/100, 1), y=response, color=control_q, group = control_q)) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr.m <- lm(response ~ 1 + prop_of_time_1 + control_q, data = contr_df)
summary(contr.m)
library(gtsummary)
contr.m %>%
tbl_regression(intercept = TRUE) %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
contr_df
contr.m <- lm(response ~ 1 + prop_of_time_1 + control_q, data = contr_df %>% filter(control_q == "Any causal control?"))
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any causal control?"))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any constraints on your control?"))
summary(contr.m)
View(math_survey %>% select(causal))
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any constraints on your control?"))
summary(contr.m)
test <- (math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) )
test
corrplot(test %>% select(prop_of_time_1::annoyed))
corrplot(test %>% select(prop_of_time_1:annoyed))
test <- (math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed)
mutate(causal = as.numeric(causal == "Yes"))
test <- (math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed)
%>% mutate(causal = as.numeric(causal == "Yes"))
)
test
test <- (math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed)
%>% mutate(causal:annoyed = as.numeric(causal:annoyed == "Yes"), )
test <- (math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed)
%>% mutate(causal = as.numeric(causal == "Yes"), constraint = as.numeric(constraint == "Yes"), appear = as.numeric(appear == "Yes"), fade = as.numeric(fade == "Yes"), stay_present = as.numeric(stay_present == "Yes"), stop_seeing = as.numeric(stop_seeing == "Yes"), annoyed = as.numeric(annoyed == "Yes"), )
)
test <- (math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed)
%>% mutate(causal = as.numeric(causal == "Yes"), constraint = as.numeric(constraint == "Yes"), appear = as.numeric(appear == "Yes"), fade = as.numeric(fade == "Yes"), stay_present = as.numeric(stay_present == "Yes"), stop_seeing = as.numeric(stop_seeing == "Yes"), annoyed = as.numeric(annoyed == "Yes"))
)
test
corrplot(test %>% select(prop_of_time_1:annoyed))
corrplot(corrs(test %>% select(prop_of_time_1:annoyed)))
corrplot(corr(test %>% select(prop_of_time_1:annoyed)))
corrplot(cor(test %>% select(prop_of_time_1:annoyed)))
corrplot(cor(test %>% select(prop_of_time_1:annoyed) %>% na.rm=F))
corrplot(cor(test %>% select(prop_of_time_1:annoyed) %>% na.omit()))
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
+ stat_summary(fun = mean, geom = "point", size = 3, position = position_dodge(width = 0.2)) +
# geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
+ stat_summary()
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
# geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
geom_smooth(method = "lm", se = F) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response)) +
stat_summary() +
geom_smooth(method = "lm", se = F) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
geom_smooth(method = "lm", se = F) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
control_table2
# Plot: Stacked bar chart for yes/no questions
ggplot(control_table2, aes(x = question, y = count, fill = response)) +
geom_bar(stat = "identity", position = "fill") +  # Use "dodge" for side-by-side bars
coord_flip() +  # Flip for readability
scale_y_continuous(labels = scales::percent_format()) + # Show proportions
labs(x = "Survey Question", y = "Proportion of Responses", fill = "Response") +
theme_minimal() +
theme(text = element_text(size = 12))
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df)
library(gtsummary)
contr.m %>%
tbl_regression(intercept = TRUE) %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
contr.m
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1 + control_q, data = contr_df)
library(gtsummary)
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any causal control?")))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any causal control?")))
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any causal control?"))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any constraints on your control?"))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Any constraints on your control?"))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Ever appear unprompted?"))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q == "Can't stop seeing them?"))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q ==  "Ever annoyed by them?" ))
summary(contr.m)
41.5/48
binom.test(500, 700)
binom.test(500*2, 700*2)
hist(log(rnorm(100, mean=1)))
x=rnorm(1000, mean=1);plot(x, log(x))
x=rnorm(1000, mean=1);plot(x[x>1], log(x[x>1]))
source("~/.active-rstudio-document", echo=TRUE)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q ==  "Ever annoyed by them?" ))
summary(contr.m)
##=---------------SIMPLER PLOT
# how much does amount of visualization affect these responses (just yes no)
contr_df <- math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) %>%
dplyr::rename(
#"Proportion of time spent visualizing" = prop_of_time_1
"Any causal control?" = causal
, "Any constraints on your control?" = constraint
, "Ever appear unprompted?"  = appear
, "Ever fade unprompted?"  = fade
, "Remain when unneeded?" = stay_present
, "Can't stop seeing them?" = stop_seeing
, "Ever annoyed by them?" = annoyed) %>%
pivot_longer(cols=c("Any causal control?":"Ever annoyed by them?"), names_to="control_q", values_to="response") %>%
mutate(response = as.numeric(response == "Yes")) %>%
drop_na(response)
contr_df
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
#stat_summary() +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
#stat_summary() +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
# geom_smooth(method = "lm", se = F) +
#theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
# geom_smooth(method = "lm", se = F) +
#theme_minimal() +
#scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/10, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
# geom_smooth(method = "lm", se = F) +
#theme_minimal() +
#scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/10, ), y=response, color=control_q, group = control_q)) +
stat_summary() +
# geom_smooth(method = "lm", se = F) +
#theme_minimal() +
#scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/10), y=response, color=control_q, group = control_q)) +
stat_summary() +
# geom_smooth(method = "lm", se = F) +
#theme_minimal() +
#scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/10), y=response, color=control_q, group = control_q)) +
stat_summary() +
geom_smooth(method = "lm", se = F) +
#theme_minimal() +
#scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed)
View(math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) )
View(math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) )
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q ==  "Any causal control?" ))
summary(contr.m)
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q !=  "Any causal control?" ))
summary(contr.m)
##---------------MORE COMPLICATED PLOT
# how much does amount of visualization affect these responses (all control qs)
contr_all_df <- math_survey %>%
select(ResponseId, prop_of_time_1, causal,constraint, appear, fade, stay_present, stop_seeing, annoyed, resist_mvmt_3, zoom_2, control_1) %>%
rename(
"Any causal control?" = causal
, "Any constraints on your control?" = constraint
, "Ever appear unprompted?"  = appear
, "Ever fade unprompted?"  = fade
, "Remain when unneeded?" = stay_present
, "Can't stop seeing them?" = stop_seeing
, "Ever annoyed by them?" = annoyed
, "How often resist movement?" = resist_mvmt_3
, "Can you zoom in?" = zoom_2
, "Make them go away?" =control_1) %>%
mutate(across(
c("Any causal control?", "Any constraints on your control?", "Ever appear unprompted?",
"Ever fade unprompted?", "Remain when unneeded?", "Can't stop seeing them?", "Ever annoyed by them?"),
~ as.numeric(. == "Yes"))) %>%
mutate(across(
c("How often resist movement?", "Can you zoom in?", "Make them go away?"),
~ . / 100)) %>%
pivot_longer(cols = c("Any causal control?":"Make them go away?"), names_to = "control_q", values_to = "response") %>%
drop_na(response)
contr_all_df %>% ggplot(aes(x=prop_of_time_1, y=response, color=control_q, group = control_q)) +
geom_smooth(method = "lm", se = T, alpha = 0.1) +
labs(title = "Control over visualizations vs. time spent visualizing",
x = "Proportion of time visualizing in a math session",
y = "Responses to Control Questions (scaled 0-1)\n0=no control, 1=total control",
color = "Control Question")
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
stat_summary() +
geom_smooth(method = "lm", se = F) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr.m <- lm(response ~ 1 + prop_of_time_1, data = contr_df %>% filter(control_q !=  "Any causal control?" ))
summary(contr.m)
library(gtsummary)
contr.m %>%
tbl_regression(intercept = TRUE) %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
contr.m <- lm(response ~ 1, data = contr_df %>% filter(control_q !=  "Any causal control?" ))
summary(contr.m)
library(gtsummary)
contr.m %>%
tbl_regression(intercept = TRUE) %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
contr.m <- lm(response ~ 1+control_q, data = contr_df %>% filter(control_q !=  "Any causal control?" ))
summary(contr.m)
library(gtsummary)
contr.m %>%
tbl_regression(intercept = TRUE) %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
?tbl_regression
??gtsummary
?gtsummary::tbl_ard_summary
contr.m %>%
tbl_ard_summary(intercept = TRUE) %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
contr.m %>%
tbl_ard_summary() %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
contr.m <- lm(response ~ 1+control_q, data = contr_df %>% filter(control_q !=  "Any causal control?" ))
summary(contr.m)
library(gtsummary)
contr.m %>%
tbl_regression(intercept = TRUE) %>%
as_gt() %>%
gt::tab_header(title = "Regression Results: Control over Visualizations")
contr_df
contr_df %>% summarise(response = sum(response), ct = length(response), .by=control_q)
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q)
binom.test(43, 55)
binom.test(33, 54)
binom.test(19, 55)
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q)
binom.test(23, 55)
##=---------------SIMPLER PLOT
# how much does amount of visualization affect these responses (just yes no)
contr_df <- math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) %>%
dplyr::rename(
#"Proportion of time spent visualizing" = prop_of_time_1
"Any causal control?" = causal
, "Any constraints on your control?" = constraint
, "Ever appear unprompted?"  = appear
, "Ever fade unprompted?"  = fade
, "Remain when unneeded?" = stay_present
, "Can't stop seeing them?" = stop_seeing
, "Ever annoyed by them?" = annoyed) %>%
pivot_longer(cols=c("Any causal control?":"Ever annoyed by them?"), names_to="control_q", values_to="response") %>%
mutate(response = as.numeric(response == "Yes")) %>%
drop_na(response)
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
#stat_summary() +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q)
#math_survey <- read_survey("~/Dropbox/Math Hallucinations/MathVisFullData20210802_anonymized.csv")
#math_survey <- read_survey("~/Downloads/Mathematical Visualization_May 22, 2024_17.34.csv")
math_survey <- read_survey("mathviz_data_clean.csv")
math_survey <- math_survey %>% filter(math_ed %in% c("Masters Degree in Math", "Ph.D. in Math", "Some Graduate Coursework"))
#math_survey <- math_survey %>% filter(Progress == 100)
math_survey <- math_survey %>% filter(Progress >= 98)
yesses <- function(v, yes="Yes"){
mean(v==yes, na.rm=T)
}
math_survey <- math_survey %>% filter(domains != "jhgfds")
math_survey <- math_survey %>% mutate(platonist = platonist_1) %>% select(-platonist_1)
#math_survey <- math_survey %>% slice(-c(1:n_bad_rows))
n_bad_rows = 0
##=---------------SIMPLER PLOT
# how much does amount of visualization affect these responses (just yes no)
contr_df <- math_survey %>%
select(ResponseId, prop_of_time_1, causal, constraint, appear, fade, stay_present, stop_seeing, annoyed) %>%
dplyr::rename(
#"Proportion of time spent visualizing" = prop_of_time_1
"Any causal control?" = causal
, "Any constraints on your control?" = constraint
, "Ever appear unprompted?"  = appear
, "Ever fade unprompted?"  = fade
, "Remain when unneeded?" = stay_present
, "Can't stop seeing them?" = stop_seeing
, "Ever annoyed by them?" = annoyed) %>%
pivot_longer(cols=c("Any causal control?":"Ever annoyed by them?"), names_to="control_q", values_to="response") %>%
mutate(response = as.numeric(response == "Yes")) %>%
drop_na(response)
contr_df %>% ggplot(aes(x=round(prop_of_time_1/100, 1), y=response, color=control_q, group = control_q)) +
#stat_summary() +
geom_smooth(method = "lm", se = F) +
theme_minimal() +
scale_y_discrete(expand = c(0,0)) +
labs(title = "Control over Visualizations vs. Time Visualizing",
x = "Proportion of time visualizing in a math session\n'Never' to 'Constantly'",
y = "Responses to Control Questions",
color = "Control Question")
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q)
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% mutate(b_mean = function(yes, ct){binom.test(yes, ct)}(yes, ct))
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% mutate(b_mean = (function(yes, ct){binom.test(yes, ct)})(yes, ct))
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% mutate(b_mean = (function(yes, ct){binom.test(yes, ct)})(yes[1], ct[1]))
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q)
binom.test(59,72)
?mapply
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% mapply(function(name, x,y){binom.test(x,y)})
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% mapply(function(name, x,y){binom.test(x,y)}, control_q, yes, ct)
?pmap
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% pmap(function(name, x,y){binom.test(x,y)})
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% map(function(name, x,y){binom.test(x,y)})
?mapply(function, ...)
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% map(function(control_q, yes, ct){binom.test(x,y)})
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% map(function(control_q, yes, ct){binom.test(yes, ct)})
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% map(function(control_q, yes, ct){print(yest)})
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% map(function(control_q, yes, ct){print(yes)})
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) %>% map(., function(control_q, yes, ct){print(yes)})
contr_df %>% summarise(yes = sum(response), ct = length(response), .by=control_q) -> summ_contr_df
pmap_int(summ_contr_df, min)
pmap_int(summ_contr_df %>% select(-control_q), min)
pmap_int(summ_contr_df %>% select(-control_q), binom.test(yes, ct))
pmap_int(summ_contr_df %>% select(-control_q), binom.test(`yes`, `ct`))
pmap_int(summ_contr_df %>% select(-control_q), binom.test)
pmap_int(summ_contr_df %>% select(-control_q)t %>% rename(x=yes), binom.test)
pmap_int(summ_contr_df %>% select(-control_q) %>% rename(x=yes), binom.test)
pmap_int(summ_contr_df %>% select(-control_q) %>% rename(x=yes, y=ct), binom.test)
pmap_int(summ_contr_df %>% select(-control_q) %>% rename(x=yes, n=ct), binom.test)
pmap_int(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$mean})
?binom.test
pmap_int(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$estimate})
pmap(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$estimate})
unlist(pmap(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$estimate}))
round(unlist(pmap(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$estimate})), 0)
round(unlist(pmap(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$estimate})), 2)
round(unlist(pmap(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$conf.int[1]})), 2)
round(unlist(pmap(summ_contr_df %>% select(-control_q) , function(yes, ct){binom.test(yes, ct)$conf.int[2]})), 2)
